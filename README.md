All of this code was written by Benedikt Hermann.
